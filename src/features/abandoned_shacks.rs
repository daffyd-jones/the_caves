use crate::enums::{Cells, Door, EnvInter, FeatureType, NPCWrap};
use crate::item::{rand_hermit_item, Item};
use crate::npc::{new_comm_npc, new_conv_npc, new_shop_npc, Convo, ShopConvos, ShopData};
use crate::parsing::{parse_map, tile_to_chars};

use rand::prelude::SliceRandom;
use rand::Rng;
use std::collections::HashMap;

const ABANDONED_SHACK_BLANK: &str = r#"Null|Null|BronzeWarAxe
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
________________________________________
"#;

const ABANDONED_SHACK_1: &str = r#"Null|Null|BronzeWarAxe
###___________________________________##
______________________________________##
____▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒___',___,',',____##
____▒_π____│________▒___',",',',',____##
____▒_____O│______.¨≡°___,',',",',._____
____▒───_──┘________▒___',',',',',."____
____▒_______________▒___',",',',",'_____
#___▒▒▒▒▒▒▒▒▒▒__▒▒▒▒▒____,',",',','_____
#____________"__",_____,',',',',',,_____
#_____.ѧ._____________',',",',',",'_____
#_____"*'_____________',",',',',',______
#_______________________________________
"#;

const ABANDONED_SHACK_2: &str = r#"Null|Null|BronzeGreatsword
#####__________________________________#
__,______.,"__,___________________,__._#
_"┌┬┬┬┬┬┬┬┬┬┐_____'__▒▒▒▒▒▒▒▒▒▒▒▒▒▒,___#
__├",*______┤__,_____▒_________≡≡_▒_____
__├',"______┤_____,"_▒____________▒_____
__├'________┤________▒___┌──┬──___▒___"_
__├_________┤___'____▒___│__2_____▒_____
__├┬┬┬┬┐_┌┬┬┤_"__________├──┘__≡≡O▒__,__
#_._____________'____▒___│_____≡≡≡▒_____
#_______,__.__*______▒___│____≡≡≡_▒,____
#___'____._______.___▒▒▒▒▒▒▒▒▒▒▒▒▒▒",___
_"__________.______*_______"",'___""____
"#;

const ABANDONED_SHACK_3: &str = r#"Null|Null|BronzeGreatsword
________________#########_______________
_,______Ʌ___Ʌ_______'___,__:┌─────┐:_,__
_____ж_Ʌ_________,_________:│~~~~~│:____
__"__жж__ѧ___Ʌ________"____:│~~~~~│:__'_
_,__________Ʌ___________.__:│~~~~~│:____
_"▒▒▒▒▒▒▒▒▒,____,",',',____:└─────┘:_,__
__▒O__│___▒"____,',',",',_____±_±______#
__▒___│___▒_____,',',',',',',_,_,_,',__#
_,▒─__┘_________,",',',",",',',",",',__#
__▒≡_____≡▒__'__,',",',',',",',',',"____
_,▒▒▒▒▒▒▒▒▒,_____',',',',',',',',','__'_
_____'____"_____________________________
"#;

const ABANDONED_SHACK_4: &str = r#"Null|Null|BronzeGreatsword
______________,___________._____########
_ʬʬʬʬʬʬʬʬʬʬʬ___________,________________
_ʬʬ,ʬʬʬʬʬʬʬʬ____._____"▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒"_
_ʬʬʬʬʬʬʬʬʬʬʬ___________▒_____│_______▒__
_ʬʬʬʬʬʬʬ"ʬʬʬ_┤_____,___▒__________π__▒,_
_ʬʬʬʬʬʬʬʬʬʬʬ_┤_________▒O____│_______▒__
_ʬʬʬʬʬʬʬʬʬʬʬ_┤_________▒─────┼────_──▒__
_ʬʬʬ.ʬʬʬʬʬʬʬ_┤_______________________▒,_
_ʬʬʬʬʬʬʬʬʬʬʬ_┤__"______▒_____│_____≡≡▒__
_ʬʬʬʬʬʬʬʬʬʬʬ_┤________,▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒__
_______┌┬┬┬┬┬┤____.____'___________'"___
###______,________________._____________
"#;

const ABANDONED_SHACK_5: &str = r#"Null|Null|BronzeLightAxe BronzeGreatsword
#_____________________________________##
_,.~~~~,__________,____________________#
_"~~~~~~~,__________ʭΠỻΠỻΠΠỻΠỻΠʭ____.___
_~~~~~~~~~,___╔═══╗_ʭ________O_ʭ________
_~~~~~~~~~.___D___║_ʭ__________ʭ________
_~~~~~~~~~~___║__O║_ʭ__________ʭ________
_"~~~~~~~~~'__╚═══╝_ʭ__________ʭ________
__,~~~~~~~,_________ỻΠỻΠĦ__ĦΠỻΠỻ________
___.~~~~~,.______________________,______
_______'"______"________________________
_______________________________________#
##_____________________________________#
"#;

const ABANDONED_SHACK_6: &str = r#"Null|Null|BronzeClaymore
##########__________#####____________###
##_______'____________'____________,_###
##_____________,_____╔═══════╤═════╗____
#___'┌┬┬┬┬┬┬┬┬┬┐'____║_______│____O║____
_____├ᘉᘊᘉᘊ_&&&&┤_____║____│________║___#
_____├ᘈᘉᘈᘍ&&&&&┤_____║π_⑁_│__│____🁢║___#
___._├_ᘈᘍᘈ_&&&_┤_____╟────┘__│_____║"___
_____├__ᘉ______┤"____║______╔╧═════╝____
_____├┬┬┬┐_┌┬┬┬┤_____║≡≡≡_______,_____##
#___________________,╚══════╝_________##
#__________________________________#####
#####________#######______________######
"#;

const ABANDONED_SHACK_7: &str = r#"Null|Null|BronzeClaymore
##########__________#####____________###
##_________________________________,_###
##__╔═══╤═════════╗_____________________
#___║O__│____π⑁___║'____________________
____║_____________║_______,____________#
____║🁢__│__╔══════╝______'~~~~~~~._____#
___.╟───┘__║______"______~~~~~~~~~______
____║____________________~~~~~~~~~______
____║___≡≡≡║___,_________~~~~~~~~_____##
#___╚══════╝______________~~~~~~______##
#__________________________________#####
#####________#######______________######
"#;

const ABANDONED_SHACK_8: &str = r#"Null|Null|BronzeClaymore
##########__________#####____________###
##_________________________________,_###
##_____.┌───┐_______.___________________
#_______│__O│,____________┌──────┐______
_______'└─_─┘.____________│,'_".'│_____#
____________"___________'╔╧══════╧╗____#
___________╭────────╮____║π_____≡≡║_____
____'______│~~~~~~~~│_______┌─_───║_____
___________│~~~~~~~~│,___║_ṑ│___🁢_║___##
#_______"__╰────────╯____╚══╧═════╝___##
#__*___________________________'___#####
#####________#######______________######
"#;

const ABANDONED_SHACK_9: &str = r#"Null|Null|MediumArmour Shroom
##########__________#####____________###
##________________,__________________###
##__▒▒▒▒▒▒▒▒▒▒▒▒▒▒'____┌┬┬┬┬┤_├┬┬┬┬┐____
#___▒O____│______▒_____├ᘈᘉᘊᘍ"__,"ᘉᘊ┤____
____▒____🁢│____⑁_▒_____├ᘉᘈᘍᘊ&&._ᘊᘈᘍ┤___#
___"▒──_──┤____π_▒____.├ᘊᘉ_&&&&,_Oᘊ┤___#
____▒____________▒_____├┬┬┬┬┬┬┬┬┬┬┬┤____
____▒▒▒▒▒▒▒_▒▒▒▒▒▒"_____________________
______________________ঌ_______________##
#______________.______ѧ_________"_____##
#__*_______________________________#####
#####________#######______________######
"#;

const ABANDONED_SHACK_10: &str = r#"Null|Null|IronLightAxe HealthPotion Apple
##########__________#####____________###
##┌┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐##
##├ʬʬʬᘍʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬᘍ┤__
#_├ʬᘈʬʬʬᘊᘈᘉᘍʬᘊᘈᘉᘍ╔═══════╤═══╗ᘉᘊᘈʬᘉᘊᘈ┤__
__├ʬ&&ᘉᘊʬʬʬʬᘈ&&ʬʬ║_______│O_≡║ʬʬʬʬᘉᘊ&┤__
__├ʬʬʬʬʬʬᘉᘊᘈᘉʬʬʬʬ╟─────_─┤🁢__║ʬ&ʬʬʬᘈᘉ┤_#
_'├╭───╮ʬʬʬʬʬʬᘈᘉᘊ║π⑁_____└─_─╢ʬᘍᘉᘉᘊᘈʬ_.#
__├│~~~│ʬᘊᘈᘉᘉᘊᘈʬO║_╔═_═╗_____║ʬʬʬᘊᘈᘉʬ┐__
__├│~~~│ʬʬ&ʬᘊᘈᘉʬ&╚═╝:·:╚═════╝&ʬʬᘊᘈʬʬ┤##
#_├╰───╯&ʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬOᘉᘊʬʬʬʬᘍ┤_#
#_├┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐&┌┬┬┬┤_#
#####________#######_"____________######
"#;

const ABANDONED_SHACK_11: &str = r#"Null|Null|HeavyArmour ShadowAxe
##########__________#####____________###
##┌┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐##
##├ʬʬʬᘍʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬᘍ┤__
#_├ʬᘈʬʬʬ╔═══╤═══════╗ᘊᘈᘉᘍʬᘊᘈᘉᘍᘉᘊᘈʬᘉᘊᘈ┤__
__├ʬ&&ᘉᘊ║__≡│______O║ʬʬʬʬᘈ&&ʬʬʬʬʬʬᘉᘊ&┤__
__├ʬʬʬᘉᘈ║🁢__├─_─────╢ʬᘉᘊᘈᘉʬʬʬʬ&&ʬ┌┬┬┬┤_#
_'├&&ʬʬʬ╟─_─┘_______║ʬʬʬʬʬʬᘈᘉᘊᘈᘍ&&____.#
__├ᘍᘈᘍᘈʬ║_______╔═_═╝ʬᘊᘈᘉᘉᘊᘈʬʬʬʬʬ┌┐_┌┐__
__├ᘉᘊᘉᘊO╚═══════╝:·:·ʬ&&ʬᘊᘈᘉʬ&&ʬʬᘊᘈʬʬ┤##
#_├ᘉᘈᘉᘈᘍ&ʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬʬᘉᘊʬʬʬʬᘍ┤_#
#_├┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┤_#
#####________#######_"____________######
"#;

const ABANDONED_SHACK_12: &str = r#"Null|Null|SteelHeavyAxe HeavyArmour
##########__________#####____________###
##_________,________'╔══════╤═══════╗###
##┌┬┬┬┬┬┬┬┬┬┬┬┐______║_____O│_____≡≡║___
#_├ᘉᘊᘈᘍᘉᘊᘈᘉᘊᘈᘍ┤______║🁢_____├─_─┬───╢___
__├ᘊᘈᘍᘉʬʬ".',"┤______╟──_───┘___D__O║__#
__├,&&&ʬʬʬ┌┐_┌┤______║__________└───╢._#
__├&&ʬʬʬ&&┤__________╚══_═╗__π⑁___≡≡║___
__├&&ʬ.&ᘉᘊ┤_╭────╮___:·:·:╚═════════╝___
__├ʬʬ&ᘉᘊᘈᘍ┤_╰╮~~~╰────╮_______"_______##
#_├┬┬┬┬┬┬┬┤_'╰╮~~~~~~~│_____ঌ_________##
#_____________╰───────╯_____ѧ______#####
#####________#######_"____________######
"#;

const ABANDONED_SHACK_13: &str = r#"Null|Null|HeavyArmour
##########__________#####____________###
##╔════╤══╤═══════╗___'____________,_###
##║___O│__│_______║┌┬┬┬┬┬┬┬┬┬┬┬┐________
#_║🁢___│__________║├ᘉᘊᘈᘍᘉᘊᘈᘍᘉᘊᘈ┤________
_.║____│__│_╔═_═══╝├______"ᘊᘈᘍᘉ┤'______#
__╟──_─┘__└─╢:·:·:·├┐_┌┐,___ʬʬʬ┤_______#
__║π⑁_____≡≡║:·:·:·____├ʬʬʬʬ&&ᘈ┤________
__╚═════════╝__________├ʬʬ.&&ᘉᘊ┤________
___"___________ঌ______.├ʬʬ&ᘉᘊᘈᘍ┤"_____##
#______________ѧ_______├┬┬┬┬┬┬┬┤______##
#_______________________'__________#####
#####________#######______________######
"#;

const ABANDONED_SHACK_14: &str = r#"Null|Null|IronHeavyAxe
##########__________#####____________###
##_________*_________.╭───────────╮_,###
##_____ঌ______________╰╮~~~~~~~~~~╰╮____
#______ѧ___,__________'╰╮~~~~~~~~~~│____
__╔══════╤══╗:·:·:·_____╰─────╮~~~~│___#
_"║π⑁____│__║:·:·:·___________╰────╯"__#
__║_________╚══_══╗┌┬┬┐_┌┬┬┐____________
__╟──_───┐________║├ʬʬʬʬ&&ᘈ┤,___________
__║______│________║├ʬʬ.&&ᘉᘊ┤__________##
#_║🁢_____│O___≡≡≡≡║├ʬʬ&ᘉᘊᘈᘍ┤__________##
#_╚══════╧════════╝├┬┬┬┬┬┬┬┤_______#####
#####___'____#######______________######
"#;

const ABANDONED_SHACK_15: &str = r#"Null|Null|HeavyArmour SteelHeavyAxe
##########__________#####____________###
##╔═══════╤═══════╗___'____________,_###
##║≡≡_____│±°×°±_ṑ║_____┌┬┬┬┬┬┬┬┬┬┬┬┐___
#_║____│__________║_____├ᘉᘊᘈᘍᘉᘊᘈᘍ&&&┤___
__║_π_O│__│_╔═_═══╝·____├&&ᘉᘊᘈᘍᘉᘊᘈᘍ&┤__#
__╟────┘__└─╢:·:·:·:·:__├ʬʬʬʬʬʬʬʬ&&&┤__#
__║______⑁__║:·:·:·:·:__├ʬʬ.ʬʬʬʬʬʬʬʬ┤___
__╟──_──┐___╚═════╗·____├ʬʬʬʬʬʬʬʬ,ʬʬ┤___
__║_____│_________║_____├ʬʬʬʬʬʬʬʬʬʬʬ┤_##
#_║🁢___O│≡≡≡≡___ṑṑ║_____├┬┬┬┬┐_┌┬┬┬┬┤_##
#_╚═════╧═════════╝________________#####
#####________#######______________######
"#;

const ABANDONED_SHACKS: [&str; 15] = [
    ABANDONED_SHACK_1,
    ABANDONED_SHACK_2,
    ABANDONED_SHACK_3,
    ABANDONED_SHACK_4,
    ABANDONED_SHACK_5,
    ABANDONED_SHACK_6,
    ABANDONED_SHACK_7,
    ABANDONED_SHACK_8,
    ABANDONED_SHACK_9,
    ABANDONED_SHACK_10,
    ABANDONED_SHACK_11,
    ABANDONED_SHACK_12,
    ABANDONED_SHACK_13,
    ABANDONED_SHACK_14,
    ABANDONED_SHACK_15,
];

pub fn make_abandoned_shack() -> (
    Vec<Vec<Cells>>,
    HashMap<(usize, usize), NPCWrap>,
    HashMap<(usize, usize), Item>,
    HashMap<(usize, usize), EnvInter>,
) {
    let cells = vec![vec![Cells::Empty; 40]; 12];
    let mut rng = rand::thread_rng();
    parse_map(
        ABANDONED_SHACKS
            .choose(&mut rng)
            .unwrap_or(&ABANDONED_SHACK_1),
        cells,
    )
}
