use crate::enums::{Cells, Door, EnvInter, FeatureType, NPCWrap};
use crate::item::{rand_hermit_item, Item};
use crate::npc::{new_comm_npc, new_conv_npc, new_shop_npc, Convo, ShopConvos, ShopData};
use crate::parsing::{parse_map, tile_to_chars};

use rand::prelude::SliceRandom;
use rand::Rng;
use std::collections::HashMap;

const SMALL_RUIN_1: &str = r#"Null|Null|Null
###___________________##########____________________________##########__________
______________________##########___,________________________##########__________
_,_ʭʭʭʭʭʭʭʭʭʭʭʭʭʭʭʭ______.________________________'_____________________________
___ʭ≡≡___±©©±_____ʭ______________________________________,___________________"__
__.ʭ_____________"ʭ_________╔════════╗__╔════════╗__╔════════╗__╔════════╗______
___ʭ______::______ʭ_________║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║____##
___ʭ______::______ʭ_________║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║____##
___ʭ"_____::______ʭ_________║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║_,__##
___ʭ_____::::_____ʭ,________╚════════╝__╚════════╝__╚════════╝__╚════════╝____##
_______:::__:::________________________________"______________________________##
_______:::_":::________"___________,_________________________________,________##
_"_____::::::::_____________╔════════╗__╔════════╗__╔════════╗__╔════════╗____##
____________________________║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║______
___.:____Ħ::Ħ____:__________║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║__║~~~~~~~~║___.__
____:,____::_____:,_______._║~~~~~~~~║__║~~~~~~~~║_.║~~~~~~~~║__║~~~~~~~~║______
____::::::::::::::__________╚════════╝__╚════════╝__╚════════╝__╚════════╝______
____:_____::"____:________________________""___________________________"________
_________::::_________,____________________________,____________________________
__'_:ỻ__Π____Π__ỻ:_____________"___##########________________,_______________###
___________________________________##########________________________________###
"#;

const SMALL_RUIN_2: &str = r#"Null|Null|Null
##______________________________________________________________________########
##___,______ᘉᘈᘊ_______┌┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐_________________________________########
____╔═════╦═══════╗___├______Ħ±Ħ______┤___╔══════╦═══════════╗________________##
____║≡≡___║_±°¤°±_║___├_┌───┐___┌───┐_┤"__║≡≡≡___║_______≡≡≡≡║________*_______##
____║_____║__:·:__║___├_│~~~│___│~~~│_┤___║_________________≡║__________________
____║________:·:__║___├_│~~~│___│~~~│_┤___║______║___________║__________________
____╠═__══╝__:·:__║___├_└───┘___└───┘_┤___╠════__╝______.____║__________________
____║________:·:__║___├_______________┤___║ᘉᘍᘈᘊ______________║____________,_____
____║_____________║___├┬┬┬┬┬┬Ħ_Ħ┬┬┬┬┬┬┤___║ᘈᘊ___________________________________
___'╚_____________╝_______________,'_____"║ᘉ____________________________________
__________:·:_______ᘉᘍᘈᘊ__________________║ᘍ_______________________~~~__________
##________:·:______ᘈᘍᘈᘊᘉᘍ__________________________:·:_&&________~~~~~~~~",_____
##________:·:_______ᘈᘊᘉᘍᘈ__________________________:·:&&&&______~~~~~~~~~~',____
##________:·:________ᘈᘊᘉ___________________________:·:_&&&_______~~~~~~~~~~.____
##________:·_··················_________,__________:·:__________~~~~~~~~~~______
__________:·······················________________________________~~~~~~~_______
___,'_____.·····_.·······_······.___________·______________________~~~______###
________________________________________________________'____________________###
#____________________________________________________________________________###
#####________________________________________________________________________###
"#;

const SMALL_RUIN_3: &str = r#"Null|Null|Null
######_______________________________________________________________________###
________________________________________________________________________________
__,____________________________________,,________________┌┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┬┐__
___'__╔═════════════════╦════════════════════════════╗___├___,_______________┤__
______║___│__±°¤°±__│___║≡≡≡≡≡≡≡≡_____________"______║,__├__┌────┐:·:┌────┐._┤__
______║___└─────────┘___║≡≡__________________________║___├__│~~~~│:·:│~~~~│__┤__
______║____:::::::::____║____________________________║___├__│~~~~│:·:│~~~~│__┤__
____,"║____:·:·:·:·:____║____________________________║___├__└────┘:·:└─~~~┘__┤__
______║____:¨:·:·:¨:____║,___________________________║___├________:·:_~~~~~__┤__
______║____:·:¨:¨:·:____╩____________.___________________├_.______:·:__~~~___┤__
______║____:¨:·:·:¨:_____________________________________├,________________,"┤__
______║_____"____________________________________________├┬┬┬┬┬┬┬Ħ___Ħ┬┬┬┬┬┬┬┤__
___.__║_________________________________________________________________________
______║________________________________________________.________________________
______╚══*,_________________══════__________══════______________________________
________"_____________________________________________________________ѧ_________
##___________________________________________'__________________________________
##__________________########__,_______________________________________________##
##________________###########_______________########__________________________##
##_______________#############__________################_________________#######
"#;

const SMALL_RUIN_0: &str = r#"
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
________________________________________________________________________________
"#;

const SMALL_RUINS: [&str; 3] = [SMALL_RUIN_1, SMALL_RUIN_2, SMALL_RUIN_3];

pub fn make_small_ruin_feature() -> (
    Vec<Vec<Cells>>,
    HashMap<(usize, usize), NPCWrap>,
    HashMap<(usize, usize), Item>,
    HashMap<(usize, usize), EnvInter>,
) {
    let cells = vec![vec![Cells::Empty; 80]; 20];
    let mut rng = rand::thread_rng();
    parse_map(SMALL_RUINS.choose(&mut rng).unwrap_or(&SMALL_RUIN_1), cells)
}
